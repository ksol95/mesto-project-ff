(()=>{"use strict";var e=function(e){e.target.closest(".card").remove()},t=function(e){e.target.classList.toggle("card__like-button_is-active")};function o(o,n,r,c){var a=o.querySelector(".card").cloneNode(!0);return a.querySelector(".card__image").src=n,a.querySelector(".card__image").setAttribute("alt",r),a.querySelector(".card__image").addEventListener("click",c),a.querySelector(".card__title").textContent=r,a.querySelector(".card__delete-button").addEventListener("click",e),a.querySelector(".card__like-button").addEventListener("click",t),a}var n=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"popup__error_visible",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"popup__input_type_error",r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),r.classList.remove(o),r.textContent=""},r=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"popup__button_disabled";!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove(o):t.classList.add(o)},c=document.querySelectorAll(".popup"),a=function(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",u)},i=function(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",u)},u=function(e){"Escape"===e.key&&a(document.querySelector(".popup_is-opened"))},s="a1b07ad8-68b9-4aea-9bd1-7f4f85e9a697",p="wff-cohort-12",l=document.querySelector("#card-template").content,d=document.querySelector(".places__list"),_=document.querySelector(".profile__title"),f=document.querySelector(".profile__image"),m=document.querySelector(".profile__description"),v=document.querySelector(".profile__edit-button"),y=document.querySelector(".popup_type_edit"),S=document.querySelector(".popup__form[name='editProfile']"),h=S.querySelector(".popup__input_type_name"),b=S.querySelector(".popup__input_type_description"),g=document.querySelector(".profile__add-button"),q=document.querySelector(".popup_type_new-card"),L=document.querySelector(".popup__form[name='new-place']"),C=L.querySelector(".popup__input[name='place-name']"),E=L.querySelector(".popup__input[name='link']"),k=document.querySelector(".popup_type_image"),A=k.querySelector(".popup__image"),j=k.querySelector(".popup__caption"),x=function(e){A.src=e.target.getAttribute("src"),A.alt=e.target.getAttribute("alt"),A.title=e.target.getAttribute("alt"),j.textContent=e.target.getAttribute("alt"),i(k)},B={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};g.addEventListener("click",(function(){i(q)})),L.addEventListener("submit",(function(e){e.preventDefault(),T(C.value,E.value),a(q),e.target.reset()})),v.addEventListener("click",(function(){h.value=_.textContent,b.value=m.textContent,function(e,t){var o=e.querySelector(t.submitButtonSelector);Array.from(e.querySelectorAll(t.inputSelector)).forEach((function(o){o.setCustomValidity(""),n(e,o,t.errorClass,t.inputErrorClass)})),o.classList.remove(t.inactiveButtonClass)}(S,B),i(y)})),S.addEventListener("submit",(function(e){e.preventDefault(),P(h.value,b.value),a(y)}));var w=function(e){_.textContent=e.name,m.textContent=e.about,f.src=e.avatar},P=function(e,t){fetch("https://nomoreparties.co/v1/".concat(p,"/users/me"),{method:"PATCH",headers:{authorization:s,"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({name:e,about:t})}).then((function(e){return e.json()})).then((function(e){return w(e)})).catch((function(e){return w({name:"Ошибка: ".concat(e),about:"Ошибка: ".concat(e),avatar:"./images/avatar.jpg"})}))},T=function(e,t){fetch("https://nomoreparties.co/v1/".concat(p,"/cards"),{method:"POST",headers:{authorization:s,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return e.json()})).then((function(e){d.prepend(o(l,e.link,e.name,x))})).catch((function(e){return console.log("Ошибка ".concat(e))}))};fetch("https://nomoreparties.co/v1/".concat(p,"/users/me"),{headers:{authorization:s}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){return w(e)})).catch((function(e){return w({name:"Ошибка: ".concat(e),about:"Ошибка: ".concat(e),avatar:"./images/avatar.jpg"})})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()}));var o=Array.from(t.querySelectorAll(e.inputSelector)),c=t.querySelector(e.submitButtonSelector);r(o,c,e.inactiveButtonClass),o.forEach((function(a){a.addEventListener("input",(function(){!function(e,t,o,r){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?n(e,t,o,r):function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"popup__error_visible",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"popup__input_type_error",c=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r),c.textContent=o,c.classList.add(n)}(e,t,t.validationMessage,o,r)}(t,a,e.errorClass,e.inputErrorClass),r(o,c,e.inactiveButtonClass)}))}))}))}(B),c.forEach((function(e){e.classList.add("popup_is-animated"),e.querySelector(".popup__close").addEventListener("click",(function(){a(e)})),e.addEventListener("click",(function(t){t.target.classList.contains("popup_is-opened")&&a(e)}))})),fetch("https://nomoreparties.co/v1/".concat(p,"/cards"),{headers:{authorization:"a1b07ad8-68b9-4aea-9bd1-7f4f85e9a697"}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){e.forEach((function(e){d.append(o(l,e.link,e.name,x))}))})).catch((function(e){return console.log("Ошибка: ".concat(e))}))})();