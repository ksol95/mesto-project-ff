(()=>{"use strict";var t=function(t){t.target.closest(".card").remove(),D(t.target.closest(".card").getAttribute("id"))},e=function(t){t.target.classList.toggle("card__like-button_is-active")};function o(o,n,r,c){var a=o.querySelector(".card").cloneNode(!0);return a.setAttribute("id",n._id),a.querySelector(".card__image").src=n.link,a.querySelector(".card__image").setAttribute("alt",n.name),a.querySelector(".card__image").addEventListener("click",c),a.querySelector(".card__title").textContent=n.name,n.owner._id===r?a.querySelector(".card__delete-button").addEventListener("click",t):a.querySelector(".card__delete-button").classList.add("hidden"),a.querySelector(".card__like-button").addEventListener("click",e),a.querySelector(".card__like-counter").textContent=n.likes.length,a}var n=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"popup__error_visible",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"popup__input_type_error",r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),r.classList.remove(o),r.textContent=""},r=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"popup__button_disabled";!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?e.classList.remove(o):e.classList.add(o)},c=document.querySelectorAll(".popup"),a=function(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",u)},i=function(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",u)},u=function(t){"Escape"===t.key&&a(document.querySelector(".popup_is-opened"))},s="a1b07ad8-68b9-4aea-9bd1-7f4f85e9a697",p="wff-cohort-12",l="",d=document.querySelector("#card-template").content,_=document.querySelector(".places__list"),f=document.querySelector(".profile__title"),m=document.querySelector(".profile__image"),v=document.querySelector(".profile__description"),y=document.querySelector(".profile__edit-button"),h=document.querySelector(".popup_type_edit"),S=document.querySelector(".popup__form[name='editProfile']"),b=S.querySelector(".popup__input_type_name"),g=S.querySelector(".popup__input_type_description"),q=document.querySelector(".profile__add-button"),L=document.querySelector(".popup_type_new-card"),C=document.querySelector(".popup__form[name='new-place']"),E=C.querySelector(".popup__input[name='place-name']"),k=C.querySelector(".popup__input[name='link']"),A=document.querySelector(".popup_type_image"),j=A.querySelector(".popup__image"),x=A.querySelector(".popup__caption"),B=function(t){j.src=t.target.getAttribute("src"),j.alt=t.target.getAttribute("alt"),j.title=t.target.getAttribute("alt"),x.textContent=t.target.getAttribute("alt"),i(A)},T={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};q.addEventListener("click",(function(){i(L)})),C.addEventListener("submit",(function(t){t.preventDefault(),P(E.value,k.value),a(L),t.target.reset()})),y.addEventListener("click",(function(){b.value=f.textContent,g.value=v.textContent,function(t,e){var o=t.querySelector(e.submitButtonSelector);Array.from(t.querySelectorAll(e.inputSelector)).forEach((function(o){o.setCustomValidity(""),n(t,o,e.errorClass,e.inputErrorClass)})),o.classList.remove(e.inactiveButtonClass)}(S,T),i(h)})),S.addEventListener("submit",(function(t){t.preventDefault(),z(b.value,g.value),a(h)}));var w=function(t){f.textContent=t.name,v.textContent=t.about,m.src=t.avatar},z=function(t,e){fetch("https://nomoreparties.co/v1/".concat(p,"/users/me"),{method:"PATCH",headers:{authorization:s,"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({name:t,about:e})}).then((function(t){return t.json()})).then((function(t){return w(t)})).catch((function(t){return w({name:"Ошибка: ".concat(t),about:"Ошибка: ".concat(t),avatar:"./images/avatar.jpg"})}))},P=function(t,e){fetch("https://nomoreparties.co/v1/".concat(p,"/cards"),{method:"POST",headers:{authorization:s,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:e})}).then((function(t){return t.json()})).then((function(t){_.prepend(o(d,t,l,B))})).catch((function(t){return console.log("Ошибка ".concat(t))}))},D=function(t){fetch("https://nomoreparties.co/v1/".concat(p,"/cards/").concat(t),{method:"DELETE",headers:{authorization:s,"Content-Type":"application/json"}})};fetch("https://nomoreparties.co/v1/".concat(p,"/users/me"),{headers:{authorization:s}}).then((function(t){return t.ok?t.json():Promise.reject(t.status)})).then((function(t){w(t),l=t._id})).catch((function(t){return w({name:"Ошибка: ".concat(t),about:"Ошибка: ".concat(t),avatar:"./images/avatar.jpg"})})),function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault()}));var o=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);r(o,c,t.inactiveButtonClass),o.forEach((function(a){a.addEventListener("input",(function(){!function(t,e,o,r){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?n(t,e,o,r):function(t,e,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"popup__error_visible",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"popup__input_type_error",c=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r),c.textContent=o,c.classList.add(n)}(t,e,e.validationMessage,o,r)}(e,a,t.errorClass,t.inputErrorClass),r(o,c,t.inactiveButtonClass)}))}))}))}(T),c.forEach((function(t){t.classList.add("popup_is-animated"),t.querySelector(".popup__close").addEventListener("click",(function(){a(t)})),t.addEventListener("click",(function(e){e.target.classList.contains("popup_is-opened")&&a(t)}))})),fetch("https://nomoreparties.co/v1/".concat(p,"/cards"),{headers:{authorization:"a1b07ad8-68b9-4aea-9bd1-7f4f85e9a697"}}).then((function(t){return t.ok?t.json():Promise.reject(t.status)})).then((function(t){t.forEach((function(t){_.append(o(d,t,l,B))}))})).catch((function(t){return console.log("Ошибка: ".concat(t))}))})();